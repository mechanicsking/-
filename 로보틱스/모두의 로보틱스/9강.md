(25.07.10 작성)
# 9강 Passive Walker
Passive walker란 다음과 같이 모터의 직접적인 힘이 아닌, 중력에 의한, 가속과 바닥과의 충격량으로 동작하는 시스템을 말한다. 일반적인 모터 제어보다 훨씬 효율적이고, 안정적인 시스템을 갖고 있어 보행을 연구 할 시 가장 기초가 되는 모델이다.    
![image](https://github.com/user-attachments/assets/b041c406-ec33-4926-ae80-d94f131d5dd0)    
따라서 이번 장에서는 이러한 passive dynamic walker model을 해석하고, hybrid system을 적용하여 직접 시뮬레이션까지 진행한다.     
## Passive Walker
passive walker은 2개의 state를 동시에 갖고 있는 로봇이다. 다음 그림과 같이 자유롭게 움직일 수 있는 swing state와 바닥에 고정되어있어 자유롭게 움직일 수 없는 stance state이다.     
![image](https://github.com/user-attachments/assets/f6160d0e-8df9-417a-9476-0530236f8e3e)    
이렇게 한개의 다리는 swing과 stance를 반복하는데 그 사이에 발생하는 이벤트가 있는데 이는 foot-strike라 하며, 이를 기점으로 swing과 stance를 판별한다.   
따라서    
1. leg swing
2. foot strike
3. leg stance

이를 반복하는 hybrid system이다.    

## walker modeling
운동방정식을 세우기 위해서는 다음의 순서를 따른다.    
1. 축설정
2. Homogeneous Matrix
3. Langrange(T-V)
4. E.L -->EOM<swing, stance)

이과정에서 유의할 점으로 Passive Walker는 계속해서 이동하는 로봇이기 때문에 바닥과 접하는 점 C1의 좌표가 계속해서 변화한다. 이러한 상황을 “Floating Base”라고 부른다.
## 첫번째 EOM
### 축설정
먼저 joint와 질점의 좌표를 세워준다.   
![image](https://github.com/user-attachments/assets/cb91ad8a-34b2-490f-bc77-72d12a724288)     
![image](https://github.com/user-attachments/assets/87b6e6c7-4309-4e8f-bc23-88cbbef11a92)    
그다음 축을 붙여준다.    
![image](https://github.com/user-attachments/assets/0601e8e5-9749-4c0d-9377-3ae1e5d59522)    
X0-->X1-->X2로 넘어가는 각각의 H를 구해주면 전체 Kinematics는 알 수 있게 된다. 
여기서 주의해야할 점은 다음과 같다.    
* 편의를 위해 C1의 좌표를 X축 기준으로 설정했다. 이에 따라 회전 행렬식의 요소에도 차이가 생김을 인지해야한다.    
* x1-->x2 사이 각도 변환은 $180-\theta_2$이지만, 방향이 시계방향이므로 -부호가 붙어 $\theta_2-180$이 되게 된다.
### Homogeneous Matrix
다음으로는 이렇게 구한 좌표와 각도를 이용하여 H를 구하고 각각 좌표의 위치를 구해주면 다음과 같다.    
![image](https://github.com/user-attachments/assets/0ecec073-bf7f-4ffc-9112-e8c7dae8db99)    
### Lagrange & E-L
이제 L을 구하기 위해 운동에너지와 위치에너지를 구해준다.   
* 운동에너지    
H를 통해 각 point의 위치를 얻어냈기 때문에 속도는 자코비안을 통해 손쉽게 계산할 수 있다.
hip joint의 무게도 고려하기에 M을 추가해주었다. 그리고 2번째 각속도를 고려할때 첫번째 leg의 각속도를 고려해야하는 것을 인지하자.
![image](https://github.com/user-attachments/assets/a1066db7-efe3-43cc-826b-7194eebd69a9)     
* 위치에너지     
  현재 walker는 기울어진 경사면을 따라 움직이다. 따라서 y좌표를 얻어내기 위해 경사각도 고려해주어야한다. 경사각 r만큼의 회적 변환을 반대로 적용해야 하므로 $R^{-1}$를 곱해주어야하는데 회전매트릭스는 $R^{-1}=R^T$이기에 방정식에 $R^T$가 곱해진 모습을 확인할 수 있다.   
![image](https://github.com/user-attachments/assets/46a1ccc9-3789-4e85-a07a-1fe4885d1b06)

이 시스템은 처음 언급한 것 처럼 hybrid system이기 때문에 2가지 운동방정식을 갖지만 지금까지 우리는 한가지 운동방정식을 구했다. 두번째 운동방정식은 어떻게 구해야할 지 고려해본다.    
## 두번째 EOM
이제 foot strike 시점의 EOM을 구해줄 것이다. 다리가 바닥면과 부딪히는 순간에 또 어떠한 힘이 발생할 것이다. 이 힘은 x, y평면에서 발생하는 힘이다. but, 우리는 joint angle인 theta를 조절하기 때문에 이 사이에 변환을 해주는 자코비안이 필요하게 된다. 따라서 다음의 식이 완성된다.     
<img width="801" height="420" alt="image" src="https://github.com/user-attachments/assets/2aa24bc1-8b0d-44a6-9259-b0893ad4f9ce" />    


