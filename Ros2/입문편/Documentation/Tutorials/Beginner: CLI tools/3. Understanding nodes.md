# Understanding nodes
* 목표: Ros2의 함수인 node를 배운다 그리고 노드와 상호작용할 수 있는 도구들을 배운다.

## Background
### 1. The Ros2 graph
앞으로 남은 몇가지 튜토리얼에서는 “ROS (2) graph"라 불리는 ros2의 core concept들을 배울 것이다. ros graph는 데이터를 동시에 처리하는 ros2요소의 네트워크이다. 모든 실행 파일과 이들 간의 연결을 모두 매핑하여 시각화하면 이를 모두 포괄한다.      
### 2. Nodes in ROS2
ros에서의 각각의 노드는 wheel motor를 제어하거나 레이저 거리측정기에서 센서데이터를 게시(publishing)하는 등 단일 목듈식 목적을 담당해야한다. 각각의 노드는 주제, 서비스, 작업 또는 매개변수를 통한 기타 노드로부터 데이터를 보내거나 받을 수 있다.    

<img width="854" height="480" alt="image" src="https://github.com/user-attachments/assets/6722cfc6-2860-471f-ad50-aa64cb25efdf" />      

전체 로보틱스 시스템은 여러 노드가 협력하여 작동하는 것으로 구성된다. ros2에서는 단일 실행파일(c++, 파이썬 등)에 하나 이상의 노드가 포함 될 수 있다.    

## Tasks
### 1. ros2 run
ros2 run명령어는 패키지에서 실행파일을 실행한다.     
```
$ros2 run <package_name> <executable_name>
```
그렇기 때문에 turtlesim 패키지를 실행할 때 다음의 명령어를 치게 된다.      
```
$ros2 run turtlesim turtlesim_node
```
여기서 패키지의 이름은 turtlesim이고 실행파일의 이름은 turtlesim_node이다. 아직 노드의 이름을 알 수 없다. ros2 node list를 이용하여 노드의 이름을 찾을 수 있다.    
### 2. ros2 node list
ros2 node list는 현재 작동중인 노드들의 이름을 보여준다. 이것은 노드와 상호작용하고 싶을 때나 시스텡이 여러 노드를 실행하고 있어 노드를 추적해야 할 때 특히 유용하다.       
turtlesim이 실행될 때 새로운 터미널을 열어 다음의 명령어를 작성하면 다음과 같은 노드의 이름을 반환한다.    
```
$ros2 node list
/turtlesim
```
새로운 터미널을 열어 teleop node를 실행한다.   
```
$ros2 run turtlesim turtle_teleop_key
```
여기서는 turtlesim이라는 패키지에 turtle_teleop_key라는 실행파일을 실행하였다.    
다시 node list를 실행하면 두개의 노드의 이름이 보인다.    
```
$ros2 node list
/turtlesim
/teleop_turtle
```

#### 2.1 Remappping
Remapping을 통해 노드 이름, 토픽 이름, 서비스 이름 등과 가튼 기본 노드 속성을 사용자 지정 값에 재할당할 수 있다. 지난 튜토리얼에서는 turtle_teleop_key에서 remapping을 진행하여 cmd_vel topic과 target turtle2를 바꾸었다.    
이제 /turtlesim 노드의 이름을 재할당 한다. 새로운 터미널을 열어 다음의 명령어를 실행한다.     
```
$ros2 run turtlesim turtlesim_node --ros-args --remap __node:=my_turtle
```
ros2 node list를 실행하면 다음의 3가지 노드 이름이 보인다.    
```
/my_turtle
/turtlesim
/teleop_turtle
```
### ros2 node info
이제 노드의 이름을 알았다면 다음의 명령어를 통해 정보에 더 접근 할 수 있다.     
```
$ros2 node info <node_name>
```
my_turtle 노드에 대해 알고자 하면 다음과 같은 정보가 뜬다.    
```
$ros2 node info /my_turtle
/my_turtle
  Subscribers:
    /parameter_events: rcl_interfaces/msg/ParameterEvent
    /turtle1/cmd_vel: geometry_msgs/msg/Twist
  Publishers:
    /parameter_events: rcl_interfaces/msg/ParameterEvent
    /rosout: rcl_interfaces/msg/Log
    /turtle1/color_sensor: turtlesim/msg/Color
    /turtle1/pose: turtlesim/msg/Pose
  Service Servers:
    /clear: std_srvs/srv/Empty
    /kill: turtlesim/srv/Kill
    /my_turtle/describe_parameters: rcl_interfaces/srv/DescribeParameters
    /my_turtle/get_parameter_types: rcl_interfaces/srv/GetParameterTypes
    /my_turtle/get_parameters: rcl_interfaces/srv/GetParameters
    /my_turtle/list_parameters: rcl_interfaces/srv/ListParameters
    /my_turtle/set_parameters: rcl_interfaces/srv/SetParameters
    /my_turtle/set_parameters_atomically: rcl_interfaces/srv/SetParametersAtomically
    /reset: std_srvs/srv/Empty
    /spawn: turtlesim/srv/Spawn
    /turtle1/set_pen: turtlesim/srv/SetPen
    /turtle1/teleport_absolute: turtlesim/srv/TeleportAbsolute
    /turtle1/teleport_relative: turtlesim/srv/TeleportRelative
  Service Clients:

  Action Servers:
    /turtle1/rotate_absolute: turtlesim/action/RotateAbsolute
  Action Clients:
```
ros2 node info는 subscribers, publishers, services, action의 리스트를 반환한다.    
이제 /teleop_turtle 노드의 info를 찾아보고 my_turtle과 무엇이 다른지 알아보자.    
```
$ ros2 node info /teleop_turtle 
/teleop_turtle
  Subscribers:
    /parameter_events: rcl_interfaces/msg/ParameterEvent
  Publishers:
    /parameter_events: rcl_interfaces/msg/ParameterEvent
    /rosout: rcl_interfaces/msg/Log
    /turtle1/cmd_vel: geometry_msgs/msg/Twist
  Service Servers:
    /teleop_turtle/describe_parameters: rcl_interfaces/srv/DescribeParameters
    /teleop_turtle/get_parameter_types: rcl_interfaces/srv/GetParameterTypes
    /teleop_turtle/get_parameters: rcl_interfaces/srv/GetParameters
    /teleop_turtle/list_parameters: rcl_interfaces/srv/ListParameters
    /teleop_turtle/set_parameters: rcl_interfaces/srv/SetParameters
    /teleop_turtle/set_parameters_atomically: rcl_interfaces/srv/SetParametersAtomically
  Service Clients:

  Action Servers:

  Action Clients:
    /turtle1/rotate_absolute: turtlesi
m/action/RotateAbsolute
```
ROS graph의 연결된 개념은 다음 튜토리얼에서 배울 것이다. 
## Summary
node는 로보틱스시스템에서 단일 모듈식 목적을 수행하는 기본적인 ros2요소이다.    
ros2 node list를 어떻게 노드의 이름을 찾는지 배웠고 ros2 node info를 통해 단일노드를 깊게 볼 수 있었다. 
